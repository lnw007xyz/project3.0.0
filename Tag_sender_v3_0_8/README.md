# TAG SENDER v3.0.8 - ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà

## üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô
- **‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô**: v3.0.8
- **‡∏ä‡∏∑‡πà‡∏≠**: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà (Improved Regression Equations)
- **‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á**: 2026-01-16
- **‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å**: v3.0.7 (GPS Trilateration + Bidirectional)

## üéØ ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏•‡∏±‡∏Å

### ‚ú® ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
1. **‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏°‡∏Å‡∏≤‡∏£ Regression ‡πÉ‡∏´‡∏°‡πà**
   - ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `regression_compare_old_vs_new_v3_0_7.xlsx`
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö "new" ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
   - ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ RMSE ‡πÅ‡∏•‡∏∞ MAE ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πà‡∏≤

2. **‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó**
   - `LINEAR_A_NEW[6][3]` - ‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå A ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Linear Regression
   - `LINEAR_B_NEW[6][3]` - ‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå B ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Linear Regression
   - `POLY_P0_NEW[6][3]` - ‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå P0 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Polynomial Regression
   - `POLY_P1_NEW[6][3]` - ‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå P1 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Polynomial Regression
   - `POLY_P2_NEW[6][3]` - ‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå P2 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Polynomial Regression

### üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel ‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á:

#### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö (Anchor A1):
```
Range      | OLD vs NEW Linear A | OLD vs NEW Poly P0     | RMSE Improvement
-----------|--------------------|-----------------------|------------------
10-50cm    | -7.92 ‚Üí -8.44      | 0.51 ‚Üí -35.53        | ‚úì ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
50-100cm   | -45.32 ‚Üí -17.33    | -269.37 ‚Üí 3.10       | ‚úì ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å
100-500cm  | -46.13 ‚Üí -41.47    | -30.91 ‚Üí -25.34      | ‚úì ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
500-1k     | -9.86 ‚Üí -9.86      | -1713.64 ‚Üí -1713.64  | = ‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°
1k-3k      | 16.21 ‚Üí -222.59    | 1971.56 ‚Üí 623.12     | ‚úì ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å
```

### üîß ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å v3.0.7
- ‚úÖ GPS Trilateration (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á Tag ‡∏à‡∏≤‡∏Å 3 Anchors)
- ‚úÖ Bidirectional Communication (‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å Node)
- ‚úÖ ESP-NOW Protocol
- ‚úÖ OLED Display (‡πÅ‡∏™‡∏î‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î GPS ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á)
- ‚úÖ UWB Distance Measurement
- ‚úÖ Smart Polling Logic
- ‚úÖ UWB Watchdog

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå
```
Tag_sender_v3_0_8/
‚îú‚îÄ‚îÄ Tag_sender_v3_0_8.ino    # ‡πÑ‡∏ü‡∏•‡πå Arduino ‡∏´‡∏•‡∏±‡∏Å
‚îî‚îÄ‚îÄ README.md                # ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
```

## üîç ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
1. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î TAG_ID ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: 7)
2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ MAC Address ‡∏Ç‡∏≠‡∏á Node Gateway ‡πÉ‡∏ô `NODE_PEER_MAC`
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ß‡∏£‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### üì° ‡∏û‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
```cpp
I2C_SDA    = 39  // OLED Display
I2C_SCL    = 38  // OLED Display
IO_RXD2    = 18  // UWB Module RX
IO_TXD2    = 17  // UWB Module TX
UWB_RST    = 16  // UWB Module Reset
```

### üì§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ Node
- ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á Raw (A1, A2, A3)
- ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô Regression Type 1 (Linear)
- ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô Regression Type 2 (Polynomial)
- ‡∏û‡∏¥‡∏Å‡∏±‡∏î GPS ‡∏Ç‡∏≠‡∏á Tag (Latitude, Longitude)

### üì• ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å Node
- ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° (START, STOP, GOTO, RETURN, EMERGENCY_STOP)
- ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (target_x, target_y)
- ‡∏û‡∏¥‡∏Å‡∏±‡∏î GPS ‡∏à‡∏≤‡∏Å Anchors

## üìä ‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (Distance Ranges)
```
Range 0: 10-50 cm
Range 1: 50-100 cm
Range 2: 100-500 cm
Range 3: 500-1000 cm
Range 4: 1000-3000 cm
Range 5: 3000+ cm
```

## üî¨ ‡∏™‡∏°‡∏Å‡∏≤‡∏£ Regression

### Linear Regression (Type 1)
```
distance_corrected = LINEAR_A_NEW[range][anchor] + LINEAR_B_NEW[range][anchor] * raw_distance
```

### Polynomial Regression (Type 2)
```
distance_corrected = POLY_P0_NEW[range][anchor] 
                   + POLY_P1_NEW[range][anchor] * raw_distance 
                   + POLY_P2_NEW[range][anchor] * raw_distance¬≤
```

## üöÄ ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°

### ‡∏ú‡πà‡∏≤‡∏ô Arduino IDE
1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `Tag_sender_v3_0_8.ino`
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏≠‡∏£‡πå‡∏î: ESP32S3 Dev Module
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
4. ‡∏Å‡∏î Upload

### ‡∏ú‡πà‡∏≤‡∏ô Command Line (Arduino CLI)
```bash
arduino-cli compile --fqbn esp32:esp32:esp32s3 Tag_sender_v3_0_8
arduino-cli upload -p COM3 --fqbn esp32:esp32:esp32s3 Tag_sender_v3_0_8
```

## üêõ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### Compilation Error (ESP-NOW Callbacks)
- **‡∏õ‡∏±‡∏ç‡∏´‡∏≤**: `invalid conversion from 'void (*)(const uint8_t*...`
- **‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: ESP32 Arduino Core v3.x (IDF 5.5+) ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô callback signatures
- **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**: ‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô v3.0.8 ‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö IDF 5.5+
  - ‡πÉ‡∏ä‡πâ `esp_now_recv_info*` ‡πÅ‡∏•‡∏∞ `wifi_tx_info_t*` ‡πÅ‡∏ó‡∏ô `uint8_t*`

### WiFi Connecting Error
- ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° `WiFi.persistent(false)` ‡πÅ‡∏•‡∏∞ `WiFi.disconnect(true)` ‡πÅ‡∏•‡πâ‡∏ß
- ‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï ESP32

### OLED ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ I2C
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Address ‡∏Ç‡∏≠‡∏á OLED (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô 0x3C)

### UWB ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Serial (RX, TX)
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Baud Rate (‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô 115200)
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ UWB Watchdog ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

## üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å v3.0.7
- **‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô**: ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•, WiFi/ESP-NOW config, ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- **‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô**: ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£ Regression ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
- ‡πÑ‡∏ü‡∏•‡πå Excel ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: `regression_compare_old_vs_new_v3_0_7.xlsx`
- ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 4/10/2025
- ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 340 ‡∏à‡∏∏‡∏î

## üë®‚Äçüíª ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤
- Platform: ESP32 Arduino Core v3.x (IDF 5.x)
- Build Date: 2026-01-16
- Version: 3.0.8

## üìÑ License
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á

---
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ**: ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå Auto-calibration ‡πÅ‡∏•‡∏∞ Adaptive Regression
