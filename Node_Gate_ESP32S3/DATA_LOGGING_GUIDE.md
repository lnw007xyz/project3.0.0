# üìä ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheets (Free & Easy)

‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Node Gateway ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Sheets ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î ESP32 ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå **Webhook** ‡∏Ç‡∏≠‡∏á Arduino IoT Cloud

---

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Google Sheets

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Sheets](https://sheets.google.com) ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà (Blank spreadsheet)
2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå ‡πÄ‡∏ä‡πà‡∏ô `UWB_Data_Logs`
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 (Row 1):
   - Cell A1: `Timestamp`
   - Cell B1: `Distance A1`
   - Cell C1: `Position X`
   - Cell D1: `Position Y`
   - Cell E1: `Status`

---

## üìù ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script

1. ‡πÉ‡∏ô Google Sheets ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π **Extensions (‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢)** > **Apps Script**
2. ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô:

```javascript
function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  var eventDate = new Date();
  
  // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Arduino Cloud (‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô Cloud)
  // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: Arduino Cloud ‡∏™‡πà‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ (Webhook per variable)
  // ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô message hook ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡∏∞ payload.
  // ‡πÅ‡∏ï‡πà‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß appendRow
  
  // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Raw Data ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô
  var logData = [
    eventDate,                 // ‡πÄ‡∏ß‡∏•‡∏≤
    JSON.stringify(data)       // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö (‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏Ñ‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á)
  ];
  
  // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ (‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á JSON ‡∏ó‡∏µ‡πà Arduino ‡∏™‡πà‡∏á‡∏°‡∏≤)
  // ‡∏õ‡∏Å‡∏ï‡∏¥ Arduino ‡∏à‡∏∞‡∏™‡πà‡∏á: { "thing_id": "...", "device_id": "...", "values": [ { "id": "...", "name": "distance_a1", "value": 250, ... } ] }
  
  var values = data.values;
  var dist_a1 = "";
  var pos_x = "";
  var pos_y = "";
  var status = "";
  
  if (values && values.length > 0) {
    for (var i = 0; i < values.length; i++) {
        var v = values[i];
        if (v.name === "distance_a1") dist_a1 = v.value;
        if (v.name === "current_x") pos_x = v.value;
        if (v.name === "current_y") pos_y = v.value;
        if (v.name === "boat_status") status = v.value;
    }
    
    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
    if (dist_a1 !== "" || pos_x !== "" || pos_y !== "") {
       sheet.appendRow([eventDate, dist_a1, pos_x, pos_y, status]);
    }
  }
  
  return ContentService.createTextOutput("Success");
}
```

3. ‡∏Å‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô üíæ **Save** (‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏ß‡πà‡∏≤ `ArduinoLogger`)
4. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **Deploy (‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)** > **New deployment (‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà)**
5. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (Select type) ‡πÄ‡∏õ‡πá‡∏ô ‚öôÔ∏è **Web app**
6. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ô‡∏µ‡πâ (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!):
   - **Description**: `Version 1`
   - **Execute as**: `Me (‡∏â‡∏±‡∏ô)`
   - **Who has access**: `Anyone (‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô)` ‚ö†Ô∏è **‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô Arduino ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤**
7. ‡∏Å‡∏î **Deploy** > ‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Authorize access) > ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Google > Advanced > Go to (unsafe) > Allow
8. **Copy URL** ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ (Web App URL) ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ

---

## üîó ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Arduino Cloud

1. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ **Things** ‡πÉ‡∏ô Arduino IoT Cloud
2. ‡∏°‡∏≠‡∏á‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π **Data forwarding (Webhook)** ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á (‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡∏°‡∏≤)
3. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° üîó **Configure** (‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏∏‡πà‡∏° Link)
4. ‡∏ß‡∏≤‡∏á **URL** ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏•‡∏á‡πÑ‡∏õ
5. ‡∏Å‡∏î **Save**

---

## ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö

1. ‡πÄ‡∏õ‡∏¥‡∏î Node Gateway ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
2. ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏û‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
3. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏ó‡∏µ‡πà Google Sheets
4. ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥! Log ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤ Google Drive ‡∏à‡∏∞‡πÄ‡∏ï‡πá‡∏°

---

## üíæ ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á SD Card (Hardware)

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á SD Card ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

1. ‡∏ï‡πà‡∏≠‡πÇ‡∏°‡∏î‡∏π‡∏• Micro SD Card ‡∏Å‡∏±‡∏ö ESP32S3:
   - **MISO**: GPIO 13
   - **MOSI**: GPIO 11
   - **SCK**:  GPIO 12
   - **CS**:   GPIO 10 (‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á)
   - **VCC**:  3.3V / 5V
   - **GND**:  GND

2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô `Node_Gate_ESP32S3.ino`:

```cpp
#include <SD.h>
#include <SPI.h>

void setupSD() {
    if(!SD.begin(10)) { // CS Pin
        Serial.println("SD Card Mount Failed");
        return;
    }
}

void logToSD(String data) {
    File file = SD.open("/datalog.csv", FILE_APPEND);
    if(file) {
        file.println(data);
        file.close();
    }
}
```

(‡πÅ‡∏ï‡πà‡∏ß‡∏¥‡∏ò‡∏µ Google Sheets ‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö!)
